{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"PnTMvZItmLY9","outputId":"fddcc3e4-113b-40db-d755-fc0df382660f"},"outputs":[{"name":"stdout","output_type":"stream","text":["‚ö†Ô∏è Data folder not found (Runtime was reset). Re-downloading now...\n","üöÄ Downloading DIBaS & SciDB...\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.12/dist-packages/PIL/TiffImagePlugin.py:950: UserWarning: Truncated File Read\n","  warnings.warn(str(msg))\n"]},{"name":"stdout","output_type":"stream","text":["‚úÖ Recovered 689 images from DIBAS\n","‚úÖ Recovered 40 images from SCIDB\n","üéâ Data Recovery Complete!\n","\n","‚öôÔ∏è Loading Data Generators...\n","Found 589 images belonging to 39 classes.\n","Found 140 images belonging to 39 classes.\n","Downloading data from https://storage.googleapis.com/keras-applications/efficientnetb0_notop.h5\n","\u001b[1m16705208/16705208\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 0us/step\n"]},{"name":"stderr","output_type":"stream","text":["/tmp/ipython-input-3674782255.py:110: UserWarning: `input_shape` is undefined or non-square, or `rows` is not in [96, 128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.\n","  mob_net = MobileNetV2(weights='imagenet', include_top=False, input_tensor=input_tensor)\n"]},{"name":"stdout","output_type":"stream","text":["Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/mobilenet_v2/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_1.0_224_no_top.h5\n","\u001b[1m9406464/9406464\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 0us/step\n","üß¨ Starting Production Training...\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.12/dist-packages/keras/src/trainers/data_adapters/py_dataset_adapter.py:121: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.\n","  self._warn_if_super_not_called()\n"]},{"name":"stdout","output_type":"stream","text":["Epoch 1/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m399s\u001b[0m 20s/step - accuracy: 0.1438 - auc: 0.6814 - loss: 3.6868 - val_accuracy: 0.3429 - val_auc: 0.9101 - val_loss: 2.3551 - learning_rate: 0.0010\n","Epoch 2/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m368s\u001b[0m 20s/step - accuracy: 0.3690 - auc: 0.9018 - loss: 2.3128 - val_accuracy: 0.4714 - val_auc: 0.9417 - val_loss: 1.9050 - learning_rate: 0.0010\n","Epoch 3/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m382s\u001b[0m 20s/step - accuracy: 0.5078 - auc: 0.9359 - loss: 1.7815 - val_accuracy: 0.6000 - val_auc: 0.9712 - val_loss: 1.4379 - learning_rate: 0.0010\n","Epoch 4/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m384s\u001b[0m 20s/step - accuracy: 0.5797 - auc: 0.9449 - loss: 1.6346 - val_accuracy: 0.6500 - val_auc: 0.9839 - val_loss: 1.1728 - learning_rate: 0.0010\n","Epoch 5/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m370s\u001b[0m 20s/step - accuracy: 0.6009 - auc: 0.9588 - loss: 1.3809 - val_accuracy: 0.6929 - val_auc: 0.9867 - val_loss: 1.0332 - learning_rate: 0.0010\n","Epoch 6/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m390s\u001b[0m 20s/step - accuracy: 0.6573 - auc: 0.9716 - loss: 1.0861 - val_accuracy: 0.7571 - val_auc: 0.9904 - val_loss: 0.8698 - learning_rate: 0.0010\n","Epoch 7/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m368s\u001b[0m 20s/step - accuracy: 0.6502 - auc: 0.9692 - loss: 1.1229 - val_accuracy: 0.8214 - val_auc: 0.9939 - val_loss: 0.7063 - learning_rate: 0.0010\n","Epoch 8/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m381s\u001b[0m 19s/step - accuracy: 0.6757 - auc: 0.9809 - loss: 0.9671 - val_accuracy: 0.7929 - val_auc: 0.9909 - val_loss: 0.7028 - learning_rate: 0.0010\n","Epoch 9/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m368s\u001b[0m 19s/step - accuracy: 0.7358 - auc: 0.9831 - loss: 0.8300 - val_accuracy: 0.8214 - val_auc: 0.9912 - val_loss: 0.6673 - learning_rate: 0.0010\n","Epoch 10/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m377s\u001b[0m 20s/step - accuracy: 0.7352 - auc: 0.9724 - loss: 0.9531 - val_accuracy: 0.7214 - val_auc: 0.9899 - val_loss: 0.7336 - learning_rate: 0.0010\n","Epoch 11/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m366s\u001b[0m 19s/step - accuracy: 0.7257 - auc: 0.9763 - loss: 0.9142 - val_accuracy: 0.8214 - val_auc: 0.9958 - val_loss: 0.5751 - learning_rate: 0.0010\n","Epoch 12/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m366s\u001b[0m 19s/step - accuracy: 0.7520 - auc: 0.9786 - loss: 0.8604 - val_accuracy: 0.8286 - val_auc: 0.9963 - val_loss: 0.5412 - learning_rate: 0.0010\n","Epoch 13/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m366s\u001b[0m 19s/step - accuracy: 0.7583 - auc: 0.9898 - loss: 0.6916 - val_accuracy: 0.8143 - val_auc: 0.9961 - val_loss: 0.5379 - learning_rate: 0.0010\n","Epoch 14/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m365s\u001b[0m 19s/step - accuracy: 0.7461 - auc: 0.9743 - loss: 0.9387 - val_accuracy: 0.8214 - val_auc: 0.9933 - val_loss: 0.5103 - learning_rate: 0.0010\n","Epoch 15/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m371s\u001b[0m 20s/step - accuracy: 0.7311 - auc: 0.9795 - loss: 0.8717 - val_accuracy: 0.8500 - val_auc: 0.9925 - val_loss: 0.5361 - learning_rate: 0.0010\n","Epoch 16/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m371s\u001b[0m 20s/step - accuracy: 0.8002 - auc: 0.9839 - loss: 0.7068 - val_accuracy: 0.8429 - val_auc: 0.9972 - val_loss: 0.4568 - learning_rate: 0.0010\n","Epoch 17/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m379s\u001b[0m 20s/step - accuracy: 0.7936 - auc: 0.9824 - loss: 0.7439 - val_accuracy: 0.8071 - val_auc: 0.9931 - val_loss: 0.5459 - learning_rate: 0.0010\n","Epoch 18/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m375s\u001b[0m 20s/step - accuracy: 0.7803 - auc: 0.9891 - loss: 0.6364 - val_accuracy: 0.8357 - val_auc: 0.9974 - val_loss: 0.4576 - learning_rate: 0.0010\n","Epoch 19/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 16s/step - accuracy: 0.7465 - auc: 0.9838 - loss: 0.7835 \n","Epoch 19: ReduceLROnPlateau reducing learning rate to 0.00020000000949949026.\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m367s\u001b[0m 19s/step - accuracy: 0.7482 - auc: 0.9839 - loss: 0.7785 - val_accuracy: 0.7929 - val_auc: 0.9931 - val_loss: 0.5370 - learning_rate: 0.0010\n","Epoch 20/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m367s\u001b[0m 19s/step - accuracy: 0.8037 - auc: 0.9868 - loss: 0.6539 - val_accuracy: 0.8429 - val_auc: 0.9905 - val_loss: 0.4593 - learning_rate: 2.0000e-04\n","Epoch 21/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m378s\u001b[0m 21s/step - accuracy: 0.7991 - auc: 0.9867 - loss: 0.6530 - val_accuracy: 0.9000 - val_auc: 0.9986 - val_loss: 0.3335 - learning_rate: 2.0000e-04\n","Epoch 22/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m366s\u001b[0m 19s/step - accuracy: 0.7919 - auc: 0.9810 - loss: 0.6964 - val_accuracy: 0.8857 - val_auc: 0.9980 - val_loss: 0.3853 - learning_rate: 2.0000e-04\n","Epoch 23/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m376s\u001b[0m 20s/step - accuracy: 0.8061 - auc: 0.9883 - loss: 0.6233 - val_accuracy: 0.8214 - val_auc: 0.9937 - val_loss: 0.4828 - learning_rate: 2.0000e-04\n","Epoch 24/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 16s/step - accuracy: 0.7876 - auc: 0.9883 - loss: 0.5970 \n","Epoch 24: ReduceLROnPlateau reducing learning rate to 4.0000001899898055e-05.\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m368s\u001b[0m 20s/step - accuracy: 0.7888 - auc: 0.9884 - loss: 0.5939 - val_accuracy: 0.8643 - val_auc: 0.9941 - val_loss: 0.4526 - learning_rate: 2.0000e-04\n","Epoch 25/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m370s\u001b[0m 20s/step - accuracy: 0.8368 - auc: 0.9949 - loss: 0.4556 - val_accuracy: 0.8429 - val_auc: 0.9945 - val_loss: 0.4023 - learning_rate: 4.0000e-05\n","Epoch 26/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m368s\u001b[0m 20s/step - accuracy: 0.8654 - auc: 0.9929 - loss: 0.4506 - val_accuracy: 0.8571 - val_auc: 0.9938 - val_loss: 0.4851 - learning_rate: 4.0000e-05\n","Epoch 27/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 16s/step - accuracy: 0.8633 - auc: 0.9940 - loss: 0.4473 \n","Epoch 27: ReduceLROnPlateau reducing learning rate to 8.000000525498762e-06.\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m369s\u001b[0m 20s/step - accuracy: 0.8618 - auc: 0.9940 - loss: 0.4501 - val_accuracy: 0.8571 - val_auc: 0.9939 - val_loss: 0.4381 - learning_rate: 4.0000e-05\n","Epoch 28/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m369s\u001b[0m 20s/step - accuracy: 0.8262 - auc: 0.9938 - loss: 0.4999 - val_accuracy: 0.8643 - val_auc: 0.9976 - val_loss: 0.4305 - learning_rate: 8.0000e-06\n","Epoch 29/50\n","\u001b[1m19/19\u001b[0m \u001b[32m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m\u001b[37m\u001b[0m \u001b[1m368s\u001b[0m 20s/step - accuracy: 0.8377 - auc: 0.9917 - loss: 0.4874 - val_accuracy: 0.8643 - val_auc: 0.9948 - val_loss: 0.3865 - learning_rate: 8.0000e-06\n","‚úÖ Training Finished. Model saved as 'best_microscope_fusion.keras'\n"]}],"source":["import os\n","import zipfile\n","import shutil\n","import tensorflow as tf\n","from PIL import Image\n","from tensorflow.keras import layers, models, optimizers, callbacks\n","from tensorflow.keras.applications import EfficientNetB0, MobileNetV2\n","from tensorflow.keras.preprocessing.image import ImageDataGenerator\n","from tensorflow.keras.mixed_precision import set_global_policy\n","\n","# ==========================================\n","# PART 1: AUTO-REPAIR DATA (If missing)\n","# ==========================================\n","DATA_DIR = 'microscopy_ai_data'\n","\n","if not os.path.exists(DATA_DIR):\n","    print(\"‚ö†Ô∏è Data folder not found (Runtime was reset). Re-downloading now...\")\n","\n","    # 1. Setup Credentials\n","    os.environ['KAGGLE_USERNAME'] = \"devisbyaru\"\n","    os.environ['KAGGLE_KEY'] = \"d2edbefb6e9fbcebcbfc646c66a96a86\"\n","\n","    # 2. Download Datasets\n","    print(\"üöÄ Downloading DIBaS & SciDB...\")\n","    os.system(\"kaggle datasets download -d samaarashidaarbi/dibas-bacterial-colony-dataset --unzip -p ./dibas_raw\")\n","    os.system(\"kaggle datasets download -d zoya77/microbial-colony-recognition-dataset --unzip -p ./scidb_raw\")\n","\n","    # 3. Process & Merge\n","    TARGET_SIZE = (224, 224)\n","    os.makedirs(DATA_DIR, exist_ok=True)\n","\n","    def process_to_master(source_path, prefix):\n","        count = 0\n","        for root, dirs, files in os.walk(source_path):\n","            class_name = os.path.basename(root)\n","            if not class_name or class_name == source_path.strip('./'): continue\n","\n","            # Clean class name (remove spaces for file safety)\n","            safe_class = \"\".join(x for x in class_name if x.isalnum())\n","            target_path = os.path.join(DATA_DIR, safe_class)\n","            os.makedirs(target_path, exist_ok=True)\n","\n","            for file in files:\n","                if file.lower().endswith(('.png', '.jpg', '.jpeg', '.tif')):\n","                    try:\n","                        with Image.open(os.path.join(root, file)) as img:\n","                            img = img.convert('RGB').resize(TARGET_SIZE)\n","                            img.save(os.path.join(target_path, f\"{prefix}_{count}.jpg\"))\n","                            count += 1\n","                    except: continue\n","        print(f\"‚úÖ Recovered {count} images from {prefix}\")\n","\n","    process_to_master('./dibas_raw', 'DIBAS')\n","    process_to_master('./scidb_raw', 'SCIDB')\n","    print(\"üéâ Data Recovery Complete!\\n\")\n","else:\n","    print(\"‚úÖ Data found. Skipping download.\\n\")\n","\n","# ==========================================\n","# PART 2: PRODUCTION TRAINING (Dual-Backbone)\n","# ==========================================\n","\n","# Use Mixed Precision for speed on Colab\n","set_global_policy('mixed_float16')\n","IMG_SIZE = (224, 224)\n","BATCH_SIZE = 32\n","\n","# 1. Intelligent Augmentation (Simulating 70k images)\n","train_datagen = ImageDataGenerator(\n","    rescale=1./255,\n","    rotation_range=180,    # Bacteria have no orientation\n","    width_shift_range=0.2,\n","    height_shift_range=0.2,\n","    zoom_range=0.3,\n","    shear_range=0.1,\n","    horizontal_flip=True,\n","    vertical_flip=True,\n","    fill_mode=\"nearest\",\n","    validation_split=0.2\n",")\n","\n","print(\"‚öôÔ∏è Loading Data Generators...\")\n","train_gen = train_datagen.flow_from_directory(\n","    DATA_DIR,\n","    target_size=IMG_SIZE,\n","    batch_size=BATCH_SIZE,\n","    class_mode='categorical',\n","    subset='training'\n",")\n","\n","val_gen = train_datagen.flow_from_directory(\n","    DATA_DIR,\n","    target_size=IMG_SIZE,\n","    batch_size=BATCH_SIZE,\n","    class_mode='categorical',\n","    subset='validation',\n","    shuffle=False\n",")\n","\n","# 2. Build Fusion Model\n","def build_fusion_model(num_classes):\n","    input_tensor = layers.Input(shape=(224, 224, 3))\n","\n","    # Backbone 1: EfficientNetB0\n","    eff_net = EfficientNetB0(weights='imagenet', include_top=False, input_tensor=input_tensor)\n","    eff_net.trainable = False\n","    x1 = layers.GlobalAveragePooling2D()(eff_net.output)\n","\n","    # Backbone 2: MobileNetV2\n","    mob_net = MobileNetV2(weights='imagenet', include_top=False, input_tensor=input_tensor)\n","    mob_net.trainable = False\n","    x2 = layers.GlobalAveragePooling2D()(mob_net.output)\n","\n","    # Fuse\n","    merged = layers.Concatenate()([x1, x2])\n","    x = layers.BatchNormalization()(merged)\n","    x = layers.Dense(256, activation='relu')(x)\n","    x = layers.Dropout(0.4)(x)\n","    output = layers.Dense(num_classes, activation='softmax', dtype='float32')(x)\n","\n","    return models.Model(inputs=input_tensor, outputs=output)\n","\n","model = build_fusion_model(train_gen.num_classes)\n","\n","model.compile(\n","    optimizer=optimizers.Adam(learning_rate=1e-3),\n","    loss='categorical_crossentropy',\n","    metrics=['accuracy', tf.keras.metrics.AUC(name='auc')]\n",")\n","\n","# 3. Train\n","print(\"üß¨ Starting Production Training...\")\n","history = model.fit(\n","    train_gen,\n","    validation_data=val_gen,\n","    epochs=50,  # High epoch count to utilize augmentation\n","    callbacks=[\n","        callbacks.EarlyStopping(monitor='val_loss', patience=8, restore_best_weights=True),\n","        callbacks.ReduceLROnPlateau(monitor='val_loss', factor=0.2, patience=3, verbose=1),\n","        callbacks.ModelCheckpoint('best_microscope_fusion.keras', save_best_only=True)\n","    ]\n",")\n","\n","print(\"‚úÖ Training Finished. Model saved as 'best_microscope_fusion.keras'\")"]},{"cell_type":"code","source":["import json\n","import tensorflow as tf\n","\n","# 1. GENERATE THE JAVASCRIPT LABEL MAP\n","# We pull the class names directly from the folder structure you created\n","classes = sorted(os.listdir('microscopy_ai_data'))\n","label_map = {i: label for i, label in enumerate(classes)}\n","\n","# Save as JSON for easy JavaScript 'fetch'\n","with open('labels.json', 'w') as f:\n","    json.dump(label_map, f, indent=4)\n","\n","# 2. CONVERT TO TFLITE WITH METADATA PREP\n","model = tf.keras.models.load_model('best_microscope_fusion.keras')\n","converter = tf.lite.TFLiteConverter.from_keras_model(model)\n","converter.optimizations = [tf.lite.Optimize.DEFAULT]\n","# Enable Select TF ops for operations not supported by TFLite built-ins\n","converter.target_spec.supported_ops = [\n","    tf.lite.OpsSet.TFLITE_BUILTINS,\n","    tf.lite.OpsSet.SELECT_TF_OPS  # Enable FlexOps\n","]\n","tflite_model = converter.convert()\n","\n","with open('microscope_ai_v1.tflite', 'wb') as f:\n","    f.write(tflite_model)\n","\n","print(\"üì¶ Production Package Ready!\")\n","print(f\"Total Species Mapped: {len(classes)}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"id":"Wo8cvWaZ956k","executionInfo":{"status":"ok","timestamp":1769576898165,"user_tz":-180,"elapsed":38296,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}},"outputId":"0e4b5470-fe92-4124-ec72-657ddb28c5d0"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["Saved artifact at '/tmp/tmpla1bltes'. The following endpoints are available:\n","\n","* Endpoint 'serve'\n","  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 224, 224, 3), dtype=tf.float32, name='input_layer')\n","Output Type:\n","  TensorSpec(shape=(None, 39), dtype=tf.float32, name=None)\n","Captures:\n","  138986493516048: TensorSpec(shape=(1, 1, 1, 3), dtype=tf.float16, name=None)\n","  138986493513552: TensorSpec(shape=(1, 1, 1, 3), dtype=tf.float16, name=None)\n","  138986370136976: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369631248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369630864: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369632016: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369632208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369632400: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369630672: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369631824: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369632784: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369633360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369630288: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369633744: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369631440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369633168: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369633552: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369631632: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369634320: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369632976: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369635088: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369632592: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369634512: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369634896: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369635472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369636048: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369635280: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369634704: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369635856: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369636432: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369637008: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369636240: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369637392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369634128: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369636816: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369637200: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369635664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369637968: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369636624: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369638736: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369631056: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369638160: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369638544: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369639120: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369639696: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369638928: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369638352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369639504: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369640080: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369640656: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369639888: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369641040: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369637776: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369640464: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369640848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369639312: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369641616: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369640272: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369642384: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369642576: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369642000: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369641808: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369641424: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429596304: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369637584: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369642192: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369641232: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369642768: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369643152: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304142992: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304141840: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304142800: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304143184: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304142032: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304136848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304141264: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304142608: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304140496: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304142416: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304141072: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304140688: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304140112: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304139536: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304140304: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304140880: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304139728: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304139152: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304138576: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304139344: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304138192: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304141456: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304138768: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304138384: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304139920: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304137616: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304138960: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304137232: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304136656: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304137808: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304137424: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304141648: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304138000: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986304137040: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369762896: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369763088: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369762320: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369761744: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369762704: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369761552: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369763664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369762512: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369761936: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369764816: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369764048: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369761360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369763472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369765200: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369762128: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369766544: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369766736: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369766160: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369766352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369764240: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369764432: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369765776: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369765584: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369765968: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369767120: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369765008: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369764624: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369767312: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369767888: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369763280: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369763856: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369767696: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369768656: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369769040: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369768080: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369770384: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369770576: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369770000: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369770192: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369768464: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369768272: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369769616: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369769424: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369769808: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369768848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369765392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369771920: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369769232: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369770960: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369766928: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369771152: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369772496: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369771536: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369772880: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369770768: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369772304: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369773648: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369771344: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369773264: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369774032: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369774224: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369771728: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369773840: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369767504: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369775376: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369774992: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369773072: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369775760: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369775184: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369777104: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369777296: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369776720: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369776912: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369774800: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369772688: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369776336: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369776144: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369775952: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369776528: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300898768: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300897616: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369772112: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300898192: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369777488: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369774416: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369775568: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369773456: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300897808: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300899152: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300898960: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300898576: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300896656: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300897232: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300896080: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300897040: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300898000: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300896272: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300895312: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300897424: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300898384: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300894544: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300896848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300894160: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300893968: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300895696: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300894352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300893584: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300893392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300895888: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300893776: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300892816: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300892432: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300894736: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300891088: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300890896: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300891472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300891280: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300893008: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300893200: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300891856: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300892048: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300890512: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300891664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300889168: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300888976: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300889552: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300889360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300895504: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300895120: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300889936: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300890128: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300889744: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300892624: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300896464: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300892240: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300888016: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300888592: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300887440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300887632: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300888400: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300890704: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300890320: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300887056: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300886864: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300886288: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986367212368: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986365812368: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986421790352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986422927440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986365797392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986370135440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420666832: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420681232: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420682192: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420682576: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420681616: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420680848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420678352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420681808: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420681040: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420675664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986440033872: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986364879696: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986364881808: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420677968: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986440033296: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369643920: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420682000: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369644304: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420680656: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138987183287248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369646416: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369642960: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986420682384: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369630480: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986369644880: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429827216: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429828176: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429827984: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429828560: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429827408: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429825680: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429826832: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429831824: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429827792: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429832208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429826064: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429828368: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429832400: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429832976: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429827024: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429834128: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429833552: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429826256: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429833744: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429832016: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429832592: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429827600: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429835472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429834320: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429835664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429835856: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429833360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429835280: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429835088: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429832784: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429833936: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429834704: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429837200: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429836240: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429837584: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429837776: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429834512: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429837392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429836816: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429836624: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429836432: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429837008: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429838736: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429838352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429838160: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429839312: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429838544: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429837968: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429840464: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429839696: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429834896: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429839120: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429840848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429836048: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429840272: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429841040: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429839504: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429840080: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429839888: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429831248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429825104: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429841232: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986429838928: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347588560: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347588176: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347588752: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347589712: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347587984: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347590096: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347590288: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347587792: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347589904: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347589328: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347589136: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347588944: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347589520: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347591248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347590672: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347591632: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347588368: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347587600: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347591824: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347592400: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347591056: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347590864: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347592208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347593168: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347592592: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347592784: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347592016: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347593360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347592976: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347593552: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347590480: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986347591440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344990480: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344990096: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344989712: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344988944: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344989136: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344991248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344989520: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344991632: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344991824: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344989904: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344991440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344992208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344990864: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344993552: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344993744: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344993168: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344993360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344988752: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344990288: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344992784: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344992592: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344994128: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344992976: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344995472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344995664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344995088: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344995280: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344991056: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344990672: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344994704: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344994512: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344994896: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344992016: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344989328: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344992400: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344996624: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344996240: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344996048: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344997200: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344997776: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344997008: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344997584: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344996432: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986485744848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138987182947600: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986486115664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986510357264: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986486108368: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508065232: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986509211152: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344997392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986511643088: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344993936: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986509219984: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344996816: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986344995856: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515203472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515217680: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515217296: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515215760: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515216528: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515212112: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508949584: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515216912: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986515215952: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508946512: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508950352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508946128: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508950736: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508949008: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508944208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508946896: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508948432: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508947472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508947664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508949776: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508950160: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508947856: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508949392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508946320: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508945936: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508950544: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508944592: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300888784: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300888208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508948240: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300886480: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508949200: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986508949968: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300886672: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300885328: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300886096: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300885904: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300885136: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300884560: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300887248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300883600: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300883984: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300887824: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300883216: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300883792: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300884944: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525050064: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300885520: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300883024: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300885712: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300884176: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300884752: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986300883408: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525049488: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525049680: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525049104: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525048912: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525051408: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525050448: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525051792: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525051984: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525049296: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525051600: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525051024: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525050832: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525050640: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525051216: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525052944: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525052560: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525052368: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525053520: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525052752: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525052176: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525054672: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525053904: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525049872: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525053328: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525055056: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525050256: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525056400: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525056592: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525056016: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525056208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525054096: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525054288: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525055632: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525055440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525056976: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525054864: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525055248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525057168: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525058128: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525054480: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525058512: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525058704: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525053712: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525058320: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525057744: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525056784: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525053136: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525057552: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525060048: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525059088: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525060432: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525060624: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525057360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525060240: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525059664: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525059472: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525059280: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525059856: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525061584: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525061200: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525061008: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525062160: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525061392: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525060816: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525063312: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525062544: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525057936: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525061968: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525063696: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525058896: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525062352: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525063504: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525064656: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525064848: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525062736: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525062928: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525064272: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525064080: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525063120: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525063888: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493511440: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493511632: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493511056: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493511248: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525064464: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493510672: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525061776: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986525065040: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493512208: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493512400: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493511824: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493512016: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493509904: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493510288: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493509712: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","  138986493513360: TensorSpec(shape=(), dtype=tf.resource, name=None)\n","üì¶ Production Package Ready!\n","Total Species Mapped: 39\n"]}]},{"cell_type":"code","source":["%%writefile microscope_desktop.py\n","import sys\n","import cv2\n","import json\n","import csv\n","import numpy as np\n","import tensorflow as tf\n","from PyQt6.QtWidgets import (QApplication, QMainWindow, QWidget, QVBoxLayout,\n","                             QHBoxLayout, QPushButton, QLabel, QFileDialog,\n","                             QComboBox, QStatusBar)\n","from PyQt6.QtCore import QTimer, Qt\n","from PyQt6.QtGui import QImage, QPixmap\n","from datetime import datetime\n","\n","# --- ALL THE DASHBOARD CODE WE BUILT GOES HERE ---\n","# (I am shortening it for the save command, but use the full PyQt6 script from earlier)\n","class LabDashboard(QMainWindow):\n","    # ... [Insert the full PyQt6 code I provided in the previous turn here] ...\n","    pass\n","\n","if __name__ == \"__main__\":\n","    app = QApplication(sys.argv)\n","    window = LabDashboard()\n","    window.show()\n","    sys.exit(app.exec())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YyTWiNQMF8xy","executionInfo":{"status":"ok","timestamp":1769578422827,"user_tz":-180,"elapsed":23,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}},"outputId":"a80b4772-fdf2-4894-cef0-9b456ce5f79b"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["Writing microscope_desktop.py\n"]}]},{"cell_type":"code","source":["import numpy as np\n","import tensorflow as tf\n","import cv2\n","import csv\n","import json\n","import os\n","from datetime import datetime\n","\n","class MicroscopeEngine:\n","    def __init__(self, model_type='tflite', lens_type='40x'):\n","        self.model_type = model_type\n","        self.lens_type = lens_type # Configurable via your 'Settings' button\n","        self.history = [] # For the 'Save CSV' feature\n","\n","    def load_model(self, path, label_path):\n","        \"\"\"Loads either TFLite or Keras depending on user settings.\"\"\"\n","        with open(label_path, 'r') as f:\n","            self.labels = json.load(f)\n","\n","        if path.endswith('.tflite'):\n","            self.interpreter = tf.lite.Interpreter(model_path=path)\n","            self.interpreter.allocate_tensors()\n","            self.input_details = self.interpreter.get_input_details()\n","            self.output_details = self.interpreter.get_output_details()\n","            self.mode = 'lite'\n","        else:\n","            self.model = tf.keras.models.load_model(path)\n","            self.mode = 'keras'\n","\n","    def process_frame(self, frame):\n","        \"\"\"Standardizes live feed or uploaded images.\"\"\"\n","        resized = cv2.resize(frame, (224, 224))\n","        normalized = resized.astype(np.float32) / 255.0\n","        return np.expand_dims(normalized, axis=0)\n","\n","    def analyze(self, frame):\n","        \"\"\"The 'Analyze' button logic.\"\"\"\n","        input_data = self.process_frame(frame)\n","\n","        if self.mode == 'lite':\n","            self.interpreter.set_tensor(self.input_details[0]['index'], input_data)\n","            self.interpreter.invoke()\n","            output = self.interpreter.get_tensor(self.output_details[0]['index'])[0]\n","        else:\n","            output = self.model.predict(input_data)[0]\n","\n","        idx = np.argmax(output)\n","        result = {\n","            \"timestamp\": datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\"),\n","            \"species\": self.labels[str(idx)],\n","            \"confidence\": f\"{output[idx]*100:.2f}%\",\n","            \"lens\": self.lens_type\n","        }\n","\n","        self.history.append(result) # Store for CSV export\n","        return result\n","\n","    def export_csv(self, filename=\"lab_report.csv\"):\n","        \"\"\"The 'Save' command logic.\"\"\"\n","        keys = self.history[0].keys() if self.history else []\n","        with open(filename, 'w', newline='') as f:\n","            dict_writer = csv.DictWriter(f, fieldnames=keys)\n","            dict_writer.writeheader()\n","            dict_writer.writerows(self.history)\n","        return os.path.abspath(filename)"],"metadata":{"id":"2XtnVjnzETQm","executionInfo":{"status":"ok","timestamp":1769578150417,"user_tz":-180,"elapsed":34,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["import sys\n","import cv2\n","import json\n","import csv\n","import numpy as np\n","import tensorflow as tf\n","from PyQt6.QtWidgets import (QApplication, QMainWindow, QWidget, QVBoxLayout,\n","                             QHBoxLayout, QPushButton, QLabel, QFileDialog,\n","                             QComboBox, QStatusBar)\n","from PyQt6.QtCore import QTimer, Qt\n","from PyQt6.QtGui import QImage, QPixmap\n","from datetime import datetime\n","\n","class LabDashboard(QMainWindow):\n","    def __init__(self):\n","        super().__init__()\n","        self.setWindowTitle(\"AI Diagnostic Microscope - Production v1.0\")\n","        self.setMinimumSize(1000, 700)\n","\n","        # 1. Initialize AI Engine Logic\n","        self.labels = self.load_labels('labels.json')\n","        self.interpreter = self.load_model('microscope_ai_v1.tflite')\n","        self.analysis_history = []\n","        self.current_lens = \"40x\"\n","\n","        # 2. Setup UI Layout\n","        self.init_ui()\n","\n","        # 3. Setup Camera Timer (for live feed)\n","        self.camera = cv2.VideoCapture(0) # 0 is usually the microscope camera\n","        self.timer = QTimer()\n","        self.timer.timeout.connect(self.update_frame)\n","        self.timer.start(30) # ~30 FPS\n","\n","    def init_ui(self):\n","        main_layout = QHBoxLayout()\n","\n","        # --- LEFT SIDE: LIVE VIEW ---\n","        left_panel = QVBoxLayout()\n","        self.video_label = QLabel(\"Camera Feed Not Detected\")\n","        self.video_label.setStyleSheet(\"background-color: black; border: 2px solid #333;\")\n","        self.video_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n","        left_panel.addWidget(self.video_label, 4)\n","\n","        # Control Buttons\n","        btn_layout = QHBoxLayout()\n","        self.btn_capture = QPushButton(\"Capture Frame\")\n","        self.btn_analyze = QPushButton(\"Analyze Species\")\n","        self.btn_upload = QPushButton(\"Upload Image\")\n","        self.btn_save = QPushButton(\"Save CSV Report\")\n","\n","        self.btn_analyze.setStyleSheet(\"background-color: #2e7d32; color: white; font-weight: bold;\")\n","\n","        btn_layout.addWidget(self.btn_capture)\n","        btn_layout.addWidget(self.btn_analyze)\n","        btn_layout.addWidget(self.btn_upload)\n","        btn_layout.addWidget(self.btn_save)\n","        left_panel.addLayout(btn_layout)\n","\n","        # --- RIGHT SIDE: RESULTS & SETTINGS ---\n","        right_panel = QVBoxLayout()\n","\n","        # Species Result Display\n","        self.result_label = QLabel(\"Result: Awaiting Analysis...\")\n","        self.result_label.setStyleSheet(\"font-size: 18px; color: #1565c0; font-weight: bold;\")\n","        self.confidence_label = QLabel(\"Confidence: --%\")\n","\n","        # Settings Group\n","        settings_label = QLabel(\"Microscope Settings\")\n","        settings_label.setStyleSheet(\"font-weight: bold; margin-top: 20px;\")\n","\n","        self.lens_selector = QComboBox()\n","        self.lens_selector.addItems([\"10x\", \"40x\", \"100x (Oil)\"])\n","        self.lens_selector.currentTextChanged.connect(self.update_settings)\n","\n","        right_panel.addWidget(self.result_label)\n","        right_panel.addWidget(self.confidence_label)\n","        right_panel.addStretch()\n","        right_panel.addWidget(settings_label)\n","        right_panel.addWidget(self.lens_selector)\n","\n","        # Connect Buttons\n","        self.btn_analyze.clicked.connect(self.run_analysis)\n","        self.btn_upload.clicked.connect(self.upload_image)\n","        self.btn_save.clicked.connect(self.save_report)\n","\n","        # Combine Panels\n","        container = QWidget()\n","        main_layout.addLayout(left_panel, 7)\n","        main_layout.addLayout(right_panel, 3)\n","        container.setLayout(main_layout)\n","        self.setCentralWidget(container)\n","        self.setStatusBar(QStatusBar())\n","\n","    # --- LOGIC METHODS ---\n","\n","    def load_labels(self, path):\n","        try:\n","            with open(path, 'r') as f: return json.load(f)\n","        except: return {0: \"Unknown\"}\n","\n","    def load_model(self, path):\n","        interpreter = tf.lite.Interpreter(model_path=path)\n","        interpreter.allocate_tensors()\n","        return interpreter\n","\n","    def update_frame(self):\n","        ret, frame = self.camera.read()\n","        if ret:\n","            self.last_frame = frame\n","            # Convert for Qt display\n","            rgb_image = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n","            h, w, ch = rgb_image.shape\n","            bytes_per_line = ch * w\n","            qt_image = QImage(rgb_image.data, w, h, bytes_per_line, QImage.Format.Format_RGB888)\n","            self.video_label.setPixmap(QPixmap.fromImage(qt_image).scaled(self.video_label.size(), Qt.AspectRatioMode.KeepAspectRatio))\n","\n","    def run_analysis(self):\n","        if hasattr(self, 'last_frame'):\n","            # Preprocess\n","            input_data = cv2.resize(self.last_frame, (224, 224))\n","            input_data = np.expand_dims(input_data.astype(np.float32) / 255.0, axis=0)\n","\n","            # Inference\n","            input_details = self.interpreter.get_input_details()\n","            output_details = self.interpreter.get_output_details()\n","            self.interpreter.set_tensor(input_details[0]['index'], input_data)\n","            self.interpreter.invoke()\n","            output = self.interpreter.get_tensor(output_details[0]['index'])[0]\n","\n","            # Results\n","            idx = np.argmax(output)\n","            species = self.labels[str(idx)]\n","            confidence = output[idx]\n","\n","            self.result_label.setText(f\"Result: {species}\")\n","            self.confidence_label.setText(f\"Confidence: {confidence*100:.2f}%\")\n","\n","            # Log for CSV\n","            self.analysis_history.append({\n","                \"Timestamp\": datetime.now().strftime(\"%H:%M:%S\"),\n","                \"Species\": species,\n","                \"Confidence\": f\"{confidence*100:.2f}%\",\n","                \"Lens\": self.current_lens\n","            })\n","\n","    def upload_image(self):\n","        file_path, _ = QFileDialog.getOpenFileName(self, \"Open Image\", \"\", \"Images (*.png *.jpg *.tif)\")\n","        if file_path:\n","            img = cv2.imread(file_path)\n","            self.last_frame = img\n","            self.run_analysis()\n","\n","    def save_report(self):\n","        if not self.analysis_history: return\n","        file_path, _ = QFileDialog.getSaveFileName(self, \"Save Report\", \"\", \"CSV Files (*.csv)\")\n","        if file_path:\n","            with open(file_path, 'w', newline='') as f:\n","                writer = csv.DictWriter(f, fieldnames=self.analysis_history[0].keys())\n","                writer.writeheader()\n","                writer.writerows(self.analysis_history)\n","            self.statusBar().showMessage(f\"Report saved to {file_path}\", 5000)\n","\n","    def update_settings(self, text):\n","        self.current_lens = text\n","        self.statusBar().showMessage(f\"Lens adjusted to {text}\")\n","\n","if __name__ == \"__main__\":\n","    app = QApplication(sys.argv)\n","    window = LabDashboard()\n","    window.show()\n","    sys.exit(app.exec())"],"metadata":{"id":"GzVxvXyoE_RP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["%%writefile microscope_desktop.py\n","import sys\n","import cv2\n","import json\n","import csv\n","import numpy as np\n","import tensorflow as tf\n","from PyQt6.QtWidgets import (QApplication, QMainWindow, QWidget, QVBoxLayout,\n","                             QHBoxLayout, QPushButton, QLabel, QFileDialog,\n","                             QComboBox, QStatusBar)\n","from PyQt6.QtCore import QTimer, Qt\n","from PyQt6.QtGui import QImage, QPixmap\n","from datetime import datetime\n","\n","class LabDashboard(QMainWindow):\n","    def __init__(self):\n","        super().__init__()\n","        self.setWindowTitle(\"AI Diagnostic Microscope - Production v1.0\")\n","        self.setMinimumSize(1000, 700)\n","        self.labels = self.load_labels('labels.json')\n","        self.interpreter = self.load_model('microscope_ai_v1.tflite')\n","        self.analysis_history = []\n","        self.current_lens = \"40x\"\n","        self.init_ui()\n","        self.camera = cv2.VideoCapture(0)\n","        self.timer = QTimer()\n","        self.timer.timeout.connect(self.update_frame)\n","        self.timer.start(30)\n","\n","    def init_ui(self):\n","        main_layout = QHBoxLayout()\n","        left_panel = QVBoxLayout()\n","        self.video_label = QLabel(\"Camera Feed Not Detected\")\n","        self.video_label.setStyleSheet(\"background-color: black; border: 2px solid #333;\")\n","        self.video_label.setAlignment(Qt.AlignmentFlag.AlignCenter)\n","        left_panel.addWidget(self.video_label, 4)\n","        btn_layout = QHBoxLayout()\n","        self.btn_capture = QPushButton(\"Capture Frame\")\n","        self.btn_analyze = QPushButton(\"Analyze Species\")\n","        self.btn_upload = QPushButton(\"Upload Image\")\n","        self.btn_save = QPushButton(\"Save CSV Report\")\n","        btn_layout.addWidget(self.btn_capture)\n","        btn_layout.addWidget(self.btn_analyze)\n","        btn_layout.addWidget(self.btn_upload)\n","        btn_layout.addWidget(self.btn_save)\n","        left_panel.addLayout(btn_layout)\n","        right_panel = QVBoxLayout()\n","        self.result_label = QLabel(\"Result: Awaiting Analysis...\")\n","        self.result_label.setStyleSheet(\"font-size: 18px; color: #1565c0; font-weight: bold;\")\n","        self.confidence_label = QLabel(\"Confidence: --%\")\n","        self.lens_selector = QComboBox()\n","        self.lens_selector.addItems([\"10x\", \"40x\", \"100x (Oil)\"])\n","        right_panel.addWidget(self.result_label)\n","        right_panel.addWidget(self.confidence_label)\n","        right_panel.addStretch()\n","        right_panel.addWidget(self.lens_selector)\n","        self.btn_analyze.clicked.connect(self.run_analysis)\n","        self.btn_upload.clicked.connect(self.upload_image)\n","        self.btn_save.clicked.connect(self.save_report)\n","        container = QWidget()\n","        main_layout.addLayout(left_panel, 7)\n","        main_layout.addLayout(right_panel, 3)\n","        container.setLayout(main_layout)\n","        self.setCentralWidget(container)\n","\n","    def load_labels(self, path):\n","        try:\n","            with open(path, 'r') as f: return json.load(f)\n","        except: return {0: \"Unknown\"}\n","\n","    def load_model(self, path):\n","        interpreter = tf.lite.Interpreter(model_path=path)\n","        interpreter.allocate_tensors()\n","        return interpreter\n","\n","    def update_frame(self):\n","        ret, frame = self.camera.read()\n","        if ret:\n","            self.last_frame = frame\n","            rgb_image = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n","            h, w, ch = rgb_image.shape\n","            qt_image = QImage(rgb_image.data, w, h, ch * w, QImage.Format.Format_RGB888)\n","            self.video_label.setPixmap(QPixmap.fromImage(qt_image).scaled(self.video_label.size(), Qt.AspectRatioMode.KeepAspectRatio))\n","\n","    def run_analysis(self):\n","        if hasattr(self, 'last_frame'):\n","            input_data = cv2.resize(self.last_frame, (224, 224))\n","            input_data = np.expand_dims(input_data.astype(np.float32) / 255.0, axis=0)\n","            input_details = self.interpreter.get_input_details()\n","            output_details = self.interpreter.get_output_details()\n","            self.interpreter.set_tensor(input_details[0]['index'], input_data)\n","            self.interpreter.invoke()\n","            output = self.interpreter.get_tensor(output_details[0]['index'])[0]\n","            idx = np.argmax(output)\n","            species = self.labels[str(idx)]\n","            conf = output[idx]\n","            self.result_label.setText(f\"Result: {species}\")\n","            self.confidence_label.setText(f\"Confidence: {conf*100:.2f}%\")\n","            self.analysis_history.append({\"Time\": datetime.now().strftime(\"%H:%M:%S\"), \"Species\": species, \"Confidence\": f\"{conf*100:.2f}%\"})\n","\n","    def upload_image(self):\n","        file_path, _ = QFileDialog.getOpenFileName(self, \"Open Image\", \"\", \"Images (*.png *.jpg *.tif)\")\n","        if file_path:\n","            self.last_frame = cv2.imread(file_path)\n","            self.run_analysis()\n","\n","    def save_report(self):\n","        if not self.analysis_history: return\n","        file_path, _ = QFileDialog.getSaveFileName(self, \"Save Report\", \"\", \"CSV Files (*.csv)\")\n","        if file_path:\n","            with open(file_path, 'w', newline='') as f:\n","                writer = csv.DictWriter(f, fieldnames=self.analysis_history[0].keys())\n","                writer.writeheader()\n","                writer.writerows(self.analysis_history)\n","\n","if __name__ == \"__main__\":\n","    app = QApplication(sys.argv)\n","    window = LabDashboard()\n","    window.show()\n","    sys.exit(app.exec())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QXfev3nKG2bG","executionInfo":{"status":"ok","timestamp":1769578661564,"user_tz":-180,"elapsed":144,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}},"outputId":"a7ad393e-1095-4af9-fe4a-15e8a9af9f58"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["Writing microscope_desktop.py\n"]}]},{"cell_type":"code","source":["%%writefile main.py\n","from kivy.app import App\n","from kivy.uix.boxlayout import BoxLayout\n","from kivy.uix.image import Image\n","from kivy.clock import Clock\n","from kivy.graphics.texture import Texture\n","import cv2\n","import tensorflow as tf\n","import numpy as np\n","import json\n","\n","class MicroscopeApp(App):\n","    def build(self):\n","        self.img1 = Image()\n","        layout = BoxLayout(orientation='vertical')\n","        layout.add_widget(self.img1)\n","\n","        # Initialize AI\n","        self.interpreter = tf.lite.Interpreter(model_path=\"microscope_ai_v1.tflite\")\n","        self.interpreter.allocate_tensors()\n","\n","        # Start Mobile Camera\n","        self.capture = cv2.VideoCapture(0)\n","        Clock.schedule_interval(self.update, 1.0/30.0)\n","        return layout\n","\n","    def update(self, dt):\n","        ret, frame = self.capture.read()\n","        if ret:\n","            # Prepare image for Kivy display\n","            buf = cv2.flip(frame, 0).tobytes()\n","            texture = Texture.create(size=(frame.shape[1], frame.shape[0]), colorfmt='bgr')\n","            texture.blit_buffer(buf, colorfmt='bgr', bufferfmt='ubyte')\n","            self.img1.texture = texture\n","\n","if __name__ == '__main__':\n","    MicroscopeApp().run()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"X-FrkoAOG9sa","executionInfo":{"status":"ok","timestamp":1769578688912,"user_tz":-180,"elapsed":163,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}},"outputId":"2689a1ee-ce22-4fee-e1ee-adc50d20f2cc"},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["Writing main.py\n"]}]},{"cell_type":"code","source":["%%writefile main.py\n","from kivy.app import App\n","from kivy.uix.boxlayout import BoxLayout\n","from kivy.uix.button import Button\n","from kivy.uix.label import QLabel\n","from kivy.uix.camera import Camera\n","import tensorflow as tf\n","import numpy as np\n","import json\n","import csv\n","from datetime import datetime\n","\n","class MicroscopeApp(App):\n","    def build(self):\n","        self.labels = self.load_labels('labels.json')\n","        self.interpreter = self.load_model('microscope_ai_v1.tflite')\n","        self.history = []\n","\n","        layout = BoxLayout(orientation='vertical', padding=10, spacing=10)\n","\n","        # 1. Live Camera Feed\n","        self.cam = Camera(play=True, resolution=(640, 480))\n","        layout.add_widget(self.cam)\n","\n","        # 2. Results Label\n","        self.result_label = QLabel(text=\"Awaiting Analysis...\", size_hint_y=None, height=100)\n","        layout.add_widget(self.result_label)\n","\n","        # 3. Control Buttons\n","        btn_layout = BoxLayout(size_hint_y=None, height=100, spacing=10)\n","\n","        analyze_btn = Button(text=\"ANALYZE\", background_color=(0, 0.7, 0, 1))\n","        analyze_btn.bind(on_press=self.run_analysis)\n","\n","        save_btn = Button(text=\"SAVE REPORT\")\n","        save_btn.bind(on_press=self.save_csv)\n","\n","        btn_layout.addWidget(analyze_btn)\n","        btn_layout.addWidget(save_btn)\n","        layout.add_widget(btn_layout)\n","\n","        return layout\n","\n","    def load_labels(self, path):\n","        with open(path, 'r') as f: return json.load(f)\n","\n","    def load_model(self, path):\n","        interpreter = tf.lite.Interpreter(model_path=path)\n","        interpreter.allocate_tensors()\n","        return interpreter\n","\n","    def run_analysis(self, instance):\n","        # Capture pixels from the live Kivy camera texture\n","        texture = self.cam.texture\n","        pixels = texture.pixels\n","        img = np.frombuffer(pixels, dtype=np.uint8).reshape(texture.height, texture.width, 4)\n","        img = img[:, :, :3] # Remove alpha channel\n","\n","        # Preprocess to 224x224\n","        img_resized = tf.image.resize(img, (224, 224)).numpy()\n","        input_data = np.expand_dims(img_resized.astype(np.float32) / 255.0, axis=0)\n","\n","        # Run AI\n","        input_details = self.interpreter.get_input_details()\n","        output_details = self.interpreter.get_output_details()\n","        self.interpreter.set_tensor(input_details[0]['index'], input_data)\n","        self.interpreter.invoke()\n","        output = self.interpreter.get_tensor(output_details[0]['index'])[0]\n","\n","        # Update UI\n","        idx = np.argmax(output)\n","        species = self.labels[str(idx)]\n","        conf = output[idx]\n","        self.result_label.text = f\"IDENTIFIED: {species}\\nCONFIDENCE: {conf*100:.2f}%\"\n","\n","        # Log to History\n","        self.history.append({\n","            \"Time\": datetime.now().strftime(\"%H:%M:%S\"),\n","            \"Species\": species,\n","            \"Confidence\": f\"{conf*100:.2f}%\"\n","        })\n","\n","    def save_csv(self, instance):\n","        if not self.history: return\n","        with open('microscope_report.csv', 'w', newline='') as f:\n","            writer = csv.DictWriter(f, fieldnames=self.history[0].keys())\n","            writer.writeheader()\n","            writer.writerows(self.history)\n","        self.result_label.text = \"CSV REPORT SAVED\"\n","\n","if __name__ == '__main__':\n","    MicroscopeApp().run()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fq-d2yrDHVnF","executionInfo":{"status":"ok","timestamp":1769578788127,"user_tz":-180,"elapsed":50,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}},"outputId":"53a37772-b177-4f12-c6b1-47851d42ac58"},"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["Overwriting main.py\n"]}]},{"cell_type":"code","source":["# 1. Install system dependencies for Android packaging\n","!sudo apt update\n","!sudo apt install -y git zip unzip openjdk-17-jdk python3-pip autoconf libtool pkg-config zlib1g-dev libncurses5-dev libncursesw5-dev libtinfo5 cmake libffi-dev libssl-dev\n","!pip install --upgrade Cython==0.29.33 virtualenv buildozer"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"n2Uu2aRfJerW","executionInfo":{"status":"ok","timestamp":1769579409522,"user_tz":-180,"elapsed":60764,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}},"outputId":"07267ea7-6427-4e70-93d7-12ed545f9647"},"execution_count":15,"outputs":[{"output_type":"stream","name":"stdout","text":["Get:1 https://cli.github.com/packages stable InRelease [3,917 B]\n","Get:2 https://cloud.r-project.org/bin/linux/ubuntu jammy-cran40/ InRelease [3,628 B]\n","Hit:3 http://archive.ubuntu.com/ubuntu jammy InRelease\n","Get:4 https://r2u.stat.illinois.edu/ubuntu jammy InRelease [6,555 B]\n","Get:5 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [128 kB]\n","Get:6 http://security.ubuntu.com/ubuntu jammy-security InRelease [129 kB]\n","Hit:7 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu jammy InRelease\n","Get:8 https://cli.github.com/packages stable/main amd64 Packages [356 B]\n","Get:9 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy InRelease [24.6 kB]\n","Get:10 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [127 kB]\n","Get:11 https://cloud.r-project.org/bin/linux/ubuntu jammy-cran40/ Packages [83.8 kB]\n","Get:12 https://r2u.stat.illinois.edu/ubuntu jammy/main amd64 Packages [2,885 kB]\n","Get:13 https://r2u.stat.illinois.edu/ubuntu jammy/main all Packages [9,664 kB]\n","Get:14 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [1,604 kB]\n","Get:15 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [3,971 kB]\n","Get:16 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy/main amd64 Packages [75.3 kB]\n","Get:17 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages [6,498 kB]\n","Get:18 http://security.ubuntu.com/ubuntu jammy-security/multiverse amd64 Packages [61.5 kB]\n","Get:19 http://archive.ubuntu.com/ubuntu jammy-updates/multiverse amd64 Packages [70.9 kB]\n","Get:20 http://security.ubuntu.com/ubuntu jammy-security/main amd64 Packages [3,640 kB]\n","Get:21 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 Packages [1,293 kB]\n","Fetched 30.3 MB in 7s (4,049 kB/s)\n","Reading package lists... Done\n","Building dependency tree... Done\n","Reading state information... Done\n","31 packages can be upgraded. Run 'apt list --upgradable' to see them.\n","\u001b[1;33mW: \u001b[0mSkipping acquire of configured file 'main/source/Sources' as repository 'https://r2u.stat.illinois.edu/ubuntu jammy InRelease' does not seem to provide it (sources.list entry misspelt?)\u001b[0m\n","Reading package lists... Done\n","Building dependency tree... Done\n","Reading state information... Done\n","autoconf is already the newest version (2.71-2).\n","autoconf set to manually installed.\n","libffi-dev is already the newest version (3.4.2-4).\n","libffi-dev set to manually installed.\n","zip is already the newest version (3.0-12build2).\n","cmake is already the newest version (3.22.1-1ubuntu1.22.04.2).\n","git is already the newest version (1:2.34.1-1ubuntu1.15).\n","libncurses5-dev is already the newest version (6.3-2ubuntu0.1).\n","unzip is already the newest version (6.0-26ubuntu3.2).\n","zlib1g-dev is already the newest version (1:1.2.11.dfsg-2ubuntu9.2).\n","zlib1g-dev set to manually installed.\n","The following packages were automatically installed and are no longer required:\n","  libbz2-dev libpkgconf3 libreadline-dev\n","Use 'sudo apt autoremove' to remove them.\n","The following additional packages will be installed:\n","  at-spi2-core fonts-dejavu-core fonts-dejavu-extra gsettings-desktop-schemas\n","  javascript-common libatk-bridge2.0-0 libatk-wrapper-java\n","  libatk-wrapper-java-jni libatk1.0-0 libatk1.0-data libatspi2.0-0\n","  libgail-common libgail18 libgtk2.0-0 libgtk2.0-bin libgtk2.0-common\n","  libjs-sphinxdoc libjs-underscore librsvg2-common libssl3 libxcomposite1\n","  libxt-dev libxtst6 libxxf86dga1 openjdk-17-jre python3-dev\n","  python3-pkg-resources python3-setuptools python3-wheel python3.10-dev\n","  session-migration x11-utils\n","Suggested packages:\n","  apache2 | lighttpd | httpd gvfs libssl-doc libtool-doc gcj-jdk libxt-doc\n","  openjdk-17-demo openjdk-17-source visualvm python-setuptools-doc mesa-utils\n","The following packages will be REMOVED:\n","  pkgconf r-base-dev\n","The following NEW packages will be installed:\n","  at-spi2-core fonts-dejavu-core fonts-dejavu-extra gsettings-desktop-schemas\n","  javascript-common libatk-bridge2.0-0 libatk-wrapper-java\n","  libatk-wrapper-java-jni libatk1.0-0 libatk1.0-data libatspi2.0-0\n","  libgail-common libgail18 libgtk2.0-0 libgtk2.0-bin libgtk2.0-common\n","  libjs-sphinxdoc libjs-underscore libncursesw5-dev librsvg2-common libtinfo5\n","  libtool libxcomposite1 libxt-dev libxtst6 libxxf86dga1 openjdk-17-jdk\n","  openjdk-17-jre pkg-config python3-dev python3-pip python3-setuptools\n","  python3-wheel python3.10-dev session-migration x11-utils\n","The following packages will be upgraded:\n","  libssl-dev libssl3 python3-pkg-resources\n","3 upgraded, 36 newly installed, 2 to remove and 28 not upgraded.\n","Need to get 15.6 MB of archives.\n","After this operation, 36.8 MB of additional disk space will be used.\n","Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 pkg-config amd64 0.29.2-1ubuntu3 [48.2 kB]\n","Get:2 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libssl-dev amd64 3.0.2-0ubuntu1.21 [2,375 kB]\n","Get:3 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy/main amd64 python3-pkg-resources all 68.1.2-2~jammy3 [216 kB]\n","Get:4 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy/main amd64 python3-setuptools all 68.1.2-2~jammy3 [465 kB]\n","Get:5 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libssl3 amd64 3.0.2-0ubuntu1.21 [1,905 kB]\n","Get:6 http://archive.ubuntu.com/ubuntu jammy/main amd64 libatspi2.0-0 amd64 2.44.0-3 [80.9 kB]\n","Get:7 http://archive.ubuntu.com/ubuntu jammy/main amd64 libxtst6 amd64 2:1.2.3-1build4 [13.4 kB]\n","Get:8 http://archive.ubuntu.com/ubuntu jammy/main amd64 session-migration amd64 0.3.6 [9,774 B]\n","Get:9 http://archive.ubuntu.com/ubuntu jammy/main amd64 gsettings-desktop-schemas all 42.0-1ubuntu1 [31.1 kB]\n","Get:10 http://archive.ubuntu.com/ubuntu jammy/main amd64 at-spi2-core amd64 2.44.0-3 [54.4 kB]\n","Get:11 http://archive.ubuntu.com/ubuntu jammy/main amd64 fonts-dejavu-core all 2.37-2build1 [1,041 kB]\n","Get:12 http://archive.ubuntu.com/ubuntu jammy/main amd64 fonts-dejavu-extra all 2.37-2build1 [2,041 kB]\n","Get:13 http://archive.ubuntu.com/ubuntu jammy/main amd64 javascript-common all 11+nmu1 [5,936 B]\n","Get:14 http://archive.ubuntu.com/ubuntu jammy/main amd64 libatk1.0-data all 2.36.0-3build1 [2,824 B]\n","Get:15 http://archive.ubuntu.com/ubuntu jammy/main amd64 libatk1.0-0 amd64 2.36.0-3build1 [51.9 kB]\n","Get:16 http://archive.ubuntu.com/ubuntu jammy/main amd64 libatk-bridge2.0-0 amd64 2.38.0-3 [66.6 kB]\n","Get:17 http://archive.ubuntu.com/ubuntu jammy/main amd64 libxcomposite1 amd64 1:0.4.5-1build2 [7,192 B]\n","Get:18 http://archive.ubuntu.com/ubuntu jammy/main amd64 libxxf86dga1 amd64 2:1.1.5-0ubuntu3 [12.6 kB]\n","Get:19 http://archive.ubuntu.com/ubuntu jammy/main amd64 x11-utils amd64 7.7+5build2 [206 kB]\n","Get:20 http://archive.ubuntu.com/ubuntu jammy/main amd64 libatk-wrapper-java all 0.38.0-5build1 [53.1 kB]\n","Get:21 http://archive.ubuntu.com/ubuntu jammy/main amd64 libatk-wrapper-java-jni amd64 0.38.0-5build1 [49.0 kB]\n","Get:22 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgtk2.0-common all 2.24.33-2ubuntu2.1 [125 kB]\n","Get:23 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgtk2.0-0 amd64 2.24.33-2ubuntu2.1 [2,038 kB]\n","Get:24 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgail18 amd64 2.24.33-2ubuntu2.1 [15.9 kB]\n","Get:25 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgail-common amd64 2.24.33-2ubuntu2.1 [132 kB]\n","Get:26 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libgtk2.0-bin amd64 2.24.33-2ubuntu2.1 [7,936 B]\n","Get:27 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-underscore all 1.13.2~dfsg-2 [118 kB]\n","Get:28 http://archive.ubuntu.com/ubuntu jammy/main amd64 libjs-sphinxdoc all 4.3.2-1 [139 kB]\n","Get:29 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libncursesw5-dev amd64 6.3-2ubuntu0.1 [790 B]\n","Get:30 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 librsvg2-common amd64 2.52.5+dfsg-3ubuntu0.2 [17.7 kB]\n","Get:31 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 libtinfo5 amd64 6.3-2ubuntu0.1 [100 kB]\n","Get:32 http://archive.ubuntu.com/ubuntu jammy/main amd64 libtool all 2.4.6-15build2 [164 kB]\n","Get:33 http://archive.ubuntu.com/ubuntu jammy/main amd64 libxt-dev amd64 1:1.2.1-1 [396 kB]\n","Get:34 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 openjdk-17-jre amd64 17.0.17+10-1~22.04 [238 kB]\n","Get:35 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 openjdk-17-jdk amd64 17.0.17+10-1~22.04 [1,521 kB]\n","Get:36 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3.10-dev amd64 3.10.12-1~22.04.13 [508 kB]\n","Get:37 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 python3-dev amd64 3.10.6-1~22.04.1 [26.0 kB]\n","Get:38 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 python3-wheel all 0.37.1-2ubuntu0.22.04.1 [32.0 kB]\n","Get:39 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 python3-pip all 22.0.2+dfsg-1ubuntu0.7 [1,306 kB]\n","Fetched 15.6 MB in 2s (9,782 kB/s)\n","debconf: unable to initialize frontend: Dialog\n","debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 78, <> line 39.)\n","debconf: falling back to frontend: Readline\n","debconf: unable to initialize frontend: Readline\n","debconf: (This frontend requires a controlling tty.)\n","debconf: falling back to frontend: Teletype\n","dpkg-preconfigure: unable to re-open stdin: \n","(Reading database ... 117540 files and directories currently installed.)\n","Removing r-base-dev (4.5.2-1.2204.0) ...\n","\u001b[1mdpkg:\u001b[0m pkgconf: dependency problems, but removing anyway as you requested:\n"," libsndfile1-dev:amd64 depends on pkg-config; however:\n","  Package pkg-config is not installed.\n","  Package pkgconf which provides pkg-config is to be removed.\n"," libmkl-dev:amd64 depends on pkg-config; however:\n","  Package pkg-config is not installed.\n","  Package pkgconf which provides pkg-config is to be removed.\n"," libglib2.0-dev:amd64 depends on pkg-config; however:\n","  Package pkg-config is not installed.\n","  Package pkgconf which provides pkg-config is to be removed.\n"," libfontconfig-dev:amd64 depends on pkg-config; however:\n","  Package pkg-config is not installed.\n","  Package pkgconf which provides pkg-config is to be removed.\n","\n","Removing pkgconf (1.8.0-1) ...\n","Removing 'diversion of /usr/bin/pkg-config to /usr/bin/pkg-config.real by pkgconf'\n","Removing 'diversion of /usr/share/aclocal/pkg.m4 to /usr/share/aclocal/pkg.real.m4 by pkgconf'\n","Removing 'diversion of /usr/share/man/man1/pkg-config.1.gz to /usr/share/man/man1/pkg-config.real.1.gz by pkgconf'\n","Removing 'diversion of /usr/share/pkg-config-crosswrapper to /usr/share/pkg-config-crosswrapper.real by pkgconf'\n","Selecting previously unselected package pkg-config.\n","(Reading database ... 117517 files and directories currently installed.)\n","Preparing to unpack .../pkg-config_0.29.2-1ubuntu3_amd64.deb ...\n","Unpacking pkg-config (0.29.2-1ubuntu3) ...\n","Preparing to unpack .../libssl-dev_3.0.2-0ubuntu1.21_amd64.deb ...\n","Unpacking libssl-dev:amd64 (3.0.2-0ubuntu1.21) over (3.0.2-0ubuntu1.20) ...\n","Preparing to unpack .../libssl3_3.0.2-0ubuntu1.21_amd64.deb ...\n","Unpacking libssl3:amd64 (3.0.2-0ubuntu1.21) over (3.0.2-0ubuntu1.20) ...\n","Setting up libssl3:amd64 (3.0.2-0ubuntu1.21) ...\n","debconf: unable to initialize frontend: Dialog\n","debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 78.)\n","debconf: falling back to frontend: Readline\n","Selecting previously unselected package libatspi2.0-0:amd64.\n","(Reading database ... 117532 files and directories currently installed.)\n","Preparing to unpack .../00-libatspi2.0-0_2.44.0-3_amd64.deb ...\n","Unpacking libatspi2.0-0:amd64 (2.44.0-3) ...\n","Selecting previously unselected package libxtst6:amd64.\n","Preparing to unpack .../01-libxtst6_2%3a1.2.3-1build4_amd64.deb ...\n","Unpacking libxtst6:amd64 (2:1.2.3-1build4) ...\n","Selecting previously unselected package session-migration.\n","Preparing to unpack .../02-session-migration_0.3.6_amd64.deb ...\n","Unpacking session-migration (0.3.6) ...\n","Selecting previously unselected package gsettings-desktop-schemas.\n","Preparing to unpack .../03-gsettings-desktop-schemas_42.0-1ubuntu1_all.deb ...\n","Unpacking gsettings-desktop-schemas (42.0-1ubuntu1) ...\n","Selecting previously unselected package at-spi2-core.\n","Preparing to unpack .../04-at-spi2-core_2.44.0-3_amd64.deb ...\n","Unpacking at-spi2-core (2.44.0-3) ...\n","Selecting previously unselected package fonts-dejavu-core.\n","Preparing to unpack .../05-fonts-dejavu-core_2.37-2build1_all.deb ...\n","Unpacking fonts-dejavu-core (2.37-2build1) ...\n","Selecting previously unselected package fonts-dejavu-extra.\n","Preparing to unpack .../06-fonts-dejavu-extra_2.37-2build1_all.deb ...\n","Unpacking fonts-dejavu-extra (2.37-2build1) ...\n","Selecting previously unselected package javascript-common.\n","Preparing to unpack .../07-javascript-common_11+nmu1_all.deb ...\n","Unpacking javascript-common (11+nmu1) ...\n","Selecting previously unselected package libatk1.0-data.\n","Preparing to unpack .../08-libatk1.0-data_2.36.0-3build1_all.deb ...\n","Unpacking libatk1.0-data (2.36.0-3build1) ...\n","Selecting previously unselected package libatk1.0-0:amd64.\n","Preparing to unpack .../09-libatk1.0-0_2.36.0-3build1_amd64.deb ...\n","Unpacking libatk1.0-0:amd64 (2.36.0-3build1) ...\n","Selecting previously unselected package libatk-bridge2.0-0:amd64.\n","Preparing to unpack .../10-libatk-bridge2.0-0_2.38.0-3_amd64.deb ...\n","Unpacking libatk-bridge2.0-0:amd64 (2.38.0-3) ...\n","Selecting previously unselected package libxcomposite1:amd64.\n","Preparing to unpack .../11-libxcomposite1_1%3a0.4.5-1build2_amd64.deb ...\n","Unpacking libxcomposite1:amd64 (1:0.4.5-1build2) ...\n","Selecting previously unselected package libxxf86dga1:amd64.\n","Preparing to unpack .../12-libxxf86dga1_2%3a1.1.5-0ubuntu3_amd64.deb ...\n","Unpacking libxxf86dga1:amd64 (2:1.1.5-0ubuntu3) ...\n","Selecting previously unselected package x11-utils.\n","Preparing to unpack .../13-x11-utils_7.7+5build2_amd64.deb ...\n","Unpacking x11-utils (7.7+5build2) ...\n","Selecting previously unselected package libatk-wrapper-java.\n","Preparing to unpack .../14-libatk-wrapper-java_0.38.0-5build1_all.deb ...\n","Unpacking libatk-wrapper-java (0.38.0-5build1) ...\n","Selecting previously unselected package libatk-wrapper-java-jni:amd64.\n","Preparing to unpack .../15-libatk-wrapper-java-jni_0.38.0-5build1_amd64.deb ...\n","Unpacking libatk-wrapper-java-jni:amd64 (0.38.0-5build1) ...\n","Selecting previously unselected package libgtk2.0-common.\n","Preparing to unpack .../16-libgtk2.0-common_2.24.33-2ubuntu2.1_all.deb ...\n","Unpacking libgtk2.0-common (2.24.33-2ubuntu2.1) ...\n","Selecting previously unselected package libgtk2.0-0:amd64.\n","Preparing to unpack .../17-libgtk2.0-0_2.24.33-2ubuntu2.1_amd64.deb ...\n","Unpacking libgtk2.0-0:amd64 (2.24.33-2ubuntu2.1) ...\n","Selecting previously unselected package libgail18:amd64.\n","Preparing to unpack .../18-libgail18_2.24.33-2ubuntu2.1_amd64.deb ...\n","Unpacking libgail18:amd64 (2.24.33-2ubuntu2.1) ...\n","Selecting previously unselected package libgail-common:amd64.\n","Preparing to unpack .../19-libgail-common_2.24.33-2ubuntu2.1_amd64.deb ...\n","Unpacking libgail-common:amd64 (2.24.33-2ubuntu2.1) ...\n","Selecting previously unselected package libgtk2.0-bin.\n","Preparing to unpack .../20-libgtk2.0-bin_2.24.33-2ubuntu2.1_amd64.deb ...\n","Unpacking libgtk2.0-bin (2.24.33-2ubuntu2.1) ...\n","Selecting previously unselected package libjs-underscore.\n","Preparing to unpack .../21-libjs-underscore_1.13.2~dfsg-2_all.deb ...\n","Unpacking libjs-underscore (1.13.2~dfsg-2) ...\n","Selecting previously unselected package libjs-sphinxdoc.\n","Preparing to unpack .../22-libjs-sphinxdoc_4.3.2-1_all.deb ...\n","Unpacking libjs-sphinxdoc (4.3.2-1) ...\n","Selecting previously unselected package libncursesw5-dev:amd64.\n","Preparing to unpack .../23-libncursesw5-dev_6.3-2ubuntu0.1_amd64.deb ...\n","Unpacking libncursesw5-dev:amd64 (6.3-2ubuntu0.1) ...\n","Selecting previously unselected package librsvg2-common:amd64.\n","Preparing to unpack .../24-librsvg2-common_2.52.5+dfsg-3ubuntu0.2_amd64.deb ...\n","Unpacking librsvg2-common:amd64 (2.52.5+dfsg-3ubuntu0.2) ...\n","Selecting previously unselected package libtinfo5:amd64.\n","Preparing to unpack .../25-libtinfo5_6.3-2ubuntu0.1_amd64.deb ...\n","Unpacking libtinfo5:amd64 (6.3-2ubuntu0.1) ...\n","Selecting previously unselected package libtool.\n","Preparing to unpack .../26-libtool_2.4.6-15build2_all.deb ...\n","Unpacking libtool (2.4.6-15build2) ...\n","Selecting previously unselected package libxt-dev:amd64.\n","Preparing to unpack .../27-libxt-dev_1%3a1.2.1-1_amd64.deb ...\n","Unpacking libxt-dev:amd64 (1:1.2.1-1) ...\n","Selecting previously unselected package openjdk-17-jre:amd64.\n","Preparing to unpack .../28-openjdk-17-jre_17.0.17+10-1~22.04_amd64.deb ...\n","Unpacking openjdk-17-jre:amd64 (17.0.17+10-1~22.04) ...\n","Selecting previously unselected package openjdk-17-jdk:amd64.\n","Preparing to unpack .../29-openjdk-17-jdk_17.0.17+10-1~22.04_amd64.deb ...\n","Unpacking openjdk-17-jdk:amd64 (17.0.17+10-1~22.04) ...\n","Selecting previously unselected package python3.10-dev.\n","Preparing to unpack .../30-python3.10-dev_3.10.12-1~22.04.13_amd64.deb ...\n","Unpacking python3.10-dev (3.10.12-1~22.04.13) ...\n","Selecting previously unselected package python3-dev.\n","Preparing to unpack .../31-python3-dev_3.10.6-1~22.04.1_amd64.deb ...\n","Unpacking python3-dev (3.10.6-1~22.04.1) ...\n","Preparing to unpack .../32-python3-pkg-resources_68.1.2-2~jammy3_all.deb ...\n","Unpacking python3-pkg-resources (68.1.2-2~jammy3) over (59.6.0-1.2ubuntu0.22.04.3) ...\n","Selecting previously unselected package python3-setuptools.\n","Preparing to unpack .../33-python3-setuptools_68.1.2-2~jammy3_all.deb ...\n","Unpacking python3-setuptools (68.1.2-2~jammy3) ...\n","Selecting previously unselected package python3-wheel.\n","Preparing to unpack .../34-python3-wheel_0.37.1-2ubuntu0.22.04.1_all.deb ...\n","Unpacking python3-wheel (0.37.1-2ubuntu0.22.04.1) ...\n","Selecting previously unselected package python3-pip.\n","Preparing to unpack .../35-python3-pip_22.0.2+dfsg-1ubuntu0.7_all.deb ...\n","Unpacking python3-pip (22.0.2+dfsg-1ubuntu0.7) ...\n","Setting up python3-pkg-resources (68.1.2-2~jammy3) ...\n","Setting up javascript-common (11+nmu1) ...\n","Setting up session-migration (0.3.6) ...\n","Created symlink /etc/systemd/user/graphical-session-pre.target.wants/session-migration.service ‚Üí /usr/lib/systemd/user/session-migration.service.\n","Setting up python3-setuptools (68.1.2-2~jammy3) ...\n","Setting up libncursesw5-dev:amd64 (6.3-2ubuntu0.1) ...\n","Setting up libtool (2.4.6-15build2) ...\n","Setting up libxtst6:amd64 (2:1.2.3-1build4) ...\n","Setting up libxxf86dga1:amd64 (2:1.1.5-0ubuntu3) ...\n","Setting up libatspi2.0-0:amd64 (2.44.0-3) ...\n","Setting up python3-wheel (0.37.1-2ubuntu0.22.04.1) ...\n","Setting up libxt-dev:amd64 (1:1.2.1-1) ...\n","Setting up libssl-dev:amd64 (3.0.2-0ubuntu1.21) ...\n","Setting up pkg-config (0.29.2-1ubuntu3) ...\n","Setting up fonts-dejavu-core (2.37-2build1) ...\n","Setting up python3-pip (22.0.2+dfsg-1ubuntu0.7) ...\n","Setting up librsvg2-common:amd64 (2.52.5+dfsg-3ubuntu0.2) ...\n","Setting up libatk1.0-data (2.36.0-3build1) ...\n","Setting up fonts-dejavu-extra (2.37-2build1) ...\n","Setting up python3.10-dev (3.10.12-1~22.04.13) ...\n","Setting up libgtk2.0-common (2.24.33-2ubuntu2.1) ...\n","Setting up libatk1.0-0:amd64 (2.36.0-3build1) ...\n","Setting up libtinfo5:amd64 (6.3-2ubuntu0.1) ...\n","Setting up libxcomposite1:amd64 (1:0.4.5-1build2) ...\n","Setting up libjs-underscore (1.13.2~dfsg-2) ...\n","Setting up gsettings-desktop-schemas (42.0-1ubuntu1) ...\n","Setting up libgtk2.0-0:amd64 (2.24.33-2ubuntu2.1) ...\n","Setting up libatk-bridge2.0-0:amd64 (2.38.0-3) ...\n","Setting up libjs-sphinxdoc (4.3.2-1) ...\n","Setting up libgail18:amd64 (2.24.33-2ubuntu2.1) ...\n","Setting up libgtk2.0-bin (2.24.33-2ubuntu2.1) ...\n","Setting up x11-utils (7.7+5build2) ...\n","Setting up libatk-wrapper-java (0.38.0-5build1) ...\n","Setting up libgail-common:amd64 (2.24.33-2ubuntu2.1) ...\n","Setting up openjdk-17-jre:amd64 (17.0.17+10-1~22.04) ...\n","Setting up openjdk-17-jdk:amd64 (17.0.17+10-1~22.04) ...\n","update-alternatives: using /usr/lib/jvm/java-17-openjdk-amd64/bin/jconsole to provide /usr/bin/jconsole (jconsole) in auto mode\n","Setting up libatk-wrapper-java-jni:amd64 (0.38.0-5build1) ...\n","Setting up python3-dev (3.10.6-1~22.04.1) ...\n","Processing triggers for libgdk-pixbuf-2.0-0:amd64 (2.42.8+dfsg-1ubuntu0.4) ...\n","Processing triggers for mailcap (3.70+nmu1ubuntu1) ...\n","Processing triggers for fontconfig (2.13.1-4.2ubuntu5) ...\n","Processing triggers for hicolor-icon-theme (0.17-2) ...\n","Processing triggers for libglib2.0-0:amd64 (2.72.4-0ubuntu2.7) ...\n","Processing triggers for libc-bin (2.35-0ubuntu3.11) ...\n","/sbin/ldconfig.real: /usr/local/lib/libtbb.so.12 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libur_adapter_opencl.so.0 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libur_adapter_level_zero.so.0 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libtbbbind_2_0.so.3 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libtbbbind_2_5.so.3 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libtbbmalloc.so.2 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libur_loader.so.0 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libtbbbind.so.3 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libtcm.so.1 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libtbbmalloc_proxy.so.2 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libtcm_debug.so.1 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libhwloc.so.15 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libur_adapter_level_zero_v2.so.0 is not a symbolic link\n","\n","/sbin/ldconfig.real: /usr/local/lib/libumf.so.1 is not a symbolic link\n","\n","Processing triggers for man-db (2.10.2-1) ...\n","Setting up at-spi2-core (2.44.0-3) ...\n","Collecting Cython==0.29.33\n","  Downloading Cython-0.29.33-py2.py3-none-any.whl.metadata (3.1 kB)\n","Collecting virtualenv\n","  Downloading virtualenv-20.36.1-py3-none-any.whl.metadata (4.7 kB)\n","Collecting buildozer\n","  Downloading buildozer-1.5.0-py3-none-any.whl.metadata (139 kB)\n","\u001b[2K     \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m139.8/139.8 kB\u001b[0m \u001b[31m4.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting distlib<1,>=0.3.7 (from virtualenv)\n","  Downloading distlib-0.4.0-py2.py3-none-any.whl.metadata (5.2 kB)\n","Requirement already satisfied: filelock<4,>=3.20.1 in /usr/local/lib/python3.12/dist-packages (from virtualenv) (3.20.3)\n","Requirement already satisfied: platformdirs<5,>=3.9.1 in /usr/local/lib/python3.12/dist-packages (from virtualenv) (4.5.1)\n","Requirement already satisfied: pexpect in /usr/local/lib/python3.12/dist-packages (from buildozer) (4.9.0)\n","Collecting sh (from buildozer)\n","  Downloading sh-2.2.2-py3-none-any.whl.metadata (3.7 kB)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.12/dist-packages (from pexpect->buildozer) (0.7.0)\n","Downloading Cython-0.29.33-py2.py3-none-any.whl (987 kB)\n","\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m987.3/987.3 kB\u001b[0m \u001b[31m18.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading virtualenv-20.36.1-py3-none-any.whl (6.0 MB)\n","\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m6.0/6.0 MB\u001b[0m \u001b[31m45.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading buildozer-1.5.0-py3-none-any.whl (86 kB)\n","\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m86.9/86.9 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading distlib-0.4.0-py2.py3-none-any.whl (469 kB)\n","\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m469.0/469.0 kB\u001b[0m \u001b[31m34.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading sh-2.2.2-py3-none-any.whl (38 kB)\n","Installing collected packages: distlib, virtualenv, sh, Cython, buildozer\n","  Attempting uninstall: Cython\n","    Found existing installation: Cython 3.0.12\n","    Uninstalling Cython-3.0.12:\n","      Successfully uninstalled Cython-3.0.12\n","Successfully installed Cython-0.29.33 buildozer-1.5.0 distlib-0.4.0 sh-2.2.2 virtualenv-20.36.1\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["Cython","cython"]},"id":"8b16d309fbec4929a6998a7b212295ef"}},"metadata":{}}]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WqoKt7nwH0h7","executionInfo":{"status":"ok","timestamp":1769578931019,"user_tz":-180,"elapsed":17754,"user":{"displayName":"Devis Byaru","userId":"10122556455519785326"}},"outputId":"0dac28fe-7a55-48d6-8e64-fc378a778e2b"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"code","source":["# The 'yes |' part automatically pipes 'y' into every question Buildozer asks\n","!yes | buildozer -v android debug"],"metadata":{"id":"8AMsgC97KxcX"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"mount_file_id":"1gWRh5yXVvijXowKtZ5959Ws8mvY_FMiu","authorship_tag":"ABX9TyNuJVeLU8vndp4J9hE52/LC"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}